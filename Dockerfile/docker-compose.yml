version: '3.9'

services:
  web:
    image: nginx:latest
    container_name: nginx_container
    ports: 
      - '80:80'
    volumes:
    #D:\repository\docker\nginx_php_python_node\Dockerfile\docker-compose.yml
      - /d/projects/code/:/var/www/
      # - /d/projects/code/work/php/:/var/www/
      - /d/projects/code/php/conffiles/dms_scm_config.php:/var/www/dms.mi.com/config/scm_config.php
      - /d/repository/docker/nginx_php_python_node/Dockerfile/conf/nginx/nginx.conf:/etc/nginx/conf.d/default.conf
      - /d/repository/docker/nginx_php_python_node/Dockerfile/conf/nginx/sites-available/:/etc/nginx/conf.d/vhosts/sites-enabled/
      - /d/repository/docker/nginx_php_python_node/Dockerfile/conf/nginx/sites-available/:/etc/nginx/conf.d/vhosts/sites-available/
    links:
      - php
    # network_mode: "host"
    networks:
      - mynetwork

  php:
    image: kumargowtham/nginx_php_python_node:v6
    container_name: php_container
    volumes:
      - /d/projects/code/:/var/www/
      # - /d/projects/code/work/php/:/var/www/
      - /d/projects/code/php/conffiles/dms_scm_config.php:/var/www/dms.mi.com/config/scm_config.php
      # - ./conf/nginx/default.conf:/etc/nginx/conf.d/default.conf
      # - ./conf/nginx/sites-enabled/:/etc/nginx/conf.d/vhosts/sites-enabled/
    networks:
      - mynetwork
  # react:
  #   image: react
  #   ports:
  #     - '3000:3000'
  #   volumes:
  #     - /d/projects/study/react/ecom3-ui:/app
  db:
    image: mysql:8.0
    container_name: db_container
    restart: always
    environment: 
      MYSQL_DATABASE: 'db'
      #So you dont have to use root. you can use if you like to use
      MYSQL_USER: 'user'
      #you can use whatever password you like
      MYSQL_PASSWORD: 'pwd'
      #password for root access
      MYSQL_ROOT_PASSWORD: 'root'
    ports:
      #ports exposed
      - '3306:3306'
    expose:
      #ports open 3306 on the container
      - '3306'
      #where our data will be persisted                                                                                
    volumes:
      - my-db:/d/projects/study/db
    networks:
      - mynetwork
  # mongo:

  # redis:
#Names our volumes
volumes:
  my-db:

networks:
  mynetwork:
    driver: bridge